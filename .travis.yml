sudo: required
language: node_js
node_js:
- node
- '8'
services:
- docker
after_success:
- docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASSWORD;
- export REPO=masterots/dndmanager
- export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH; fi`
- docker build -f Dockerfile -t $REPO:$COMMIT .
- docker tag $REPO:$COMMIT $REPO:$TAG
- docker tag $REPO:$COMMIT $REPO:travis-$TRAVIS_BUILD_NUMBER
- docker push $REPO;
env:
  global:
  - secure: R82TsnexfuJzqIZruRMEbyCOk2yH8flo9oIbe2/rhsqjqBlghgskYuDM6EdwWHfrCPEO5hp9HPIZSCcID5Tm4EYrgWyPJ/BTN0b/GA5Q+krHysNbHoeqnDbaTixcEUCEUmR84uXInVbLVtKANmC2h9jXWqKlhdzE1iJP14PeIkAT/k7pmcVVel+9TRjKpP5Agl3iy4+U0uN92EjL+dEV9yuCyZ4eyP17UlkfTyY+TpnpWA6ReLyRnu6SC44unVPdmWTnUVpxIdY6yq2oi2S2ls0FvOin4JXfz56XRC0F3GmeZNIJ/T6F944WUNviol7tWaEBTrGepI1DqFGYi+5y9U7fTHzirQNgMz0/Ss/+oA/GsWIyBCVFzYnT+8le4dfiuDHzM8OJP+negGcBXtIixf8TioOmPxN41CcS0agNM1tk9A++Ke9UWtIb1ylRt0RlKBdodrqEngaQ3jCK7BKj8RG2x+/pQFaiMVG+0f7ZTUNOIznWHq98SSg2rmsc7yqYmzks1lz/p0YajjXl4Q9zoYnvRYHlU8l6h/1MQ7y0wMG+HO6aoFGIadunQI0H6DEDrbHuaTbY9d5BhxlaNbR+o7PB9tSCh4IDxY2pJTHnA/xRAP1GdtUYklcwEe88bHfU5gmDYdfKHhdsUjOoJVdL0CnviT3SxMdhcxuHwUKx07U= # DOCKER_EMAIL
  - secure: hHYVxI6neeVUykgRfK7MxZUuGw5z60I8FUKRdNEr72ayBzbeX8g/qQ3BqSAc6Axk399SzR4uc6tzn58wgoVWB42TvhhWcRhJyo3pJHN8fKAXy5LZl9E8WvDfGti629F62e4tqfqJ3TT/B2h6B9m22s4hZB1m5HJZUGDtllpi3OO+JhYOP3y8hcQiVby/d1zuSFbVzPlFcYV8aES5h32Hn2uBb5xxP5SUD/zx8MFr50FV9oF7tKVmNedB5iwpTuz4mW3feeJdRq2uYS2/dpoIY8k/z5eQDOr84D4hLOa6gAfNZG74IPg0QQjueIj5Ecy6gzzoiWf8px3zt02wM1lxIi+cYacmDKvj1VzQ+GR/yuPrvKHIXgDT1oHX8qhANM+NGgFQ2R0XCDNc/q8CBFYYFedP1IXyDT0R+9kJmaUn2JCXBh5qF+Ghd3vv2WIsqXYH80WmUldMlTZY9ilwMS2F30F12GZ0j1zXciSn9ThYKTNrqlwmQH12cyz2V8YCmR/Iv1O6sra7RFxMgvQBYSjHCnOEB9i1R4U0/IqxXs+8qlKDaRTjAo3QphNaokX9JmDIBhSwLuluDVbLt2eBkITm71fAKc1ZnzVp5masuzJM4fqZscWd/NeeLTGZMlGugUKug2/eZUas8FEY3S7KgDB6az1g+nY7v5xUupjXxVyORwU= # DOCKER_USER
  - secure: oWDwF07x+3DbtXzwaA/lZ+dVoaukRDvX0GUWag7+AuHAwOztde7RzuiArzSy+8iaUXb4ami4p7xfGSpU+6JL/OnZV1xa+xkV5Ylp6yEIFLNAexRo7fkPL4ui59vs3PTY7HHFtz7oMtoTCNDU5XBR2asjyPcnB4k8wp7GeCPBl2KpKtTDI82JaFfTPSRKoGFOmP4TRwYJIyzb/NrpmKIpPbwkkraA+wNTRNoPqoygAgak02JqodoE7M2W5p5DYdRydrq1YYNUruKG1tNbwe9TC1aOgIp4bvTAC3lHZlUbA9zq7eyYHSzzzz1YdDNTU67NHLm83pz26Mu7oDtbFKqhoTdI8260jMfsiXl9nyXYnRnjrd3BTt1eJvpMWMMOwAY9EbQ+FbUacd/rLRMv4Ba0d0Fs+0ter8g6WKSRxULWFheNO/EvcaHJQ2W7+2nG5RFOcstttTic8AHqzo32BgwVNNeEjdyT/4KP6mh5xvf5UXSLhXd2nAR8ZwYXk1If0nscY1pfABI1QAxHPZhTGXY5BkPEZeuDbn1790+gVozXxDiH19spIj6iEK36aVuIPkT8aAOmZBogk05KFWjmZeAN9uL1E6lQOU/svhtUWcxwZBz9Jf9lvtLjvjLE0zKw+Svm2dh4Ip5ZX8EzhPI+x5krABYIbxYfOa051pJx7ndt2gc= # DOCKER_PASS
  - COMMIT=${TRAVIS_COMMIT::8}
